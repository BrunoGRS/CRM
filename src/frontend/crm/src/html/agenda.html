<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoffeeCRM - Agenda</title>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Raleway:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./assets/style.css">
</head>
<body>
<div id="sidebar-container"></div>

<div class="content">
    <h3 class="titulo mb-3">Agenda</h3>
    <div class="filters">
        <button class="active" onclick="filterEvents('todas')">Todas</button>
        <button class="realizadas" onclick="filterEvents('realizadas')">Realizadas</button>
        <button class="atraso" onclick="filterEvents('atraso')">Em Atraso</button>
        <button class="futuras" onclick="filterEvents('futuras')">Futuras</button>
        <button class="btn btn-sm btn-outline-dark float-end">+ Novo Evento</button>
    </div>
<div id="calendar"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
<script>
fetch('./assets/sidebar.html')
.then(response => response.text())
.then(data => {
document.getElementById('sidebar-container').innerHTML = data;

const currentPage = window.location.pathname.split("/").pop();
document.querySelectorAll('.sidebar .nav-link').forEach(link => {
    const linkPage = link.getAttribute('href');
    if (linkPage === currentPage) link.classList.add('active');
});
})
.catch(error => console.error('Erro ao carregar sidebar:', error));

let allEvents = [
    { id: '1', title: 'IBRAFLEX IN', start: '2025-09-01T10:00:00', color: '#eabf52', type: 'realizadas' },
    { id: '2', title: 'OESTE CENT', start: '2025-09-03T11:45:00', color: '#eabf52', type: 'futuras' },
    { id: '3', title: 'Vidas Corridas', start: '2025-09-04T09:00:00', color: '#e55b68', type: 'atraso' },
    { id: '4', title: 'Expresso 330', start: '2025-09-07T08:45:00', color: '#6abf6a', type: 'realizadas' },
];

let calendar;

document.addEventListener('DOMContentLoaded', function () {
    var calendarEl = document.getElementById('calendar');
    calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'pt-br',
        headerToolbar: {
        left: 'prev,next',
        center: 'title',
        right: 'dayGridMonth'
        },
        events: allEvents
    });
    calendar.render();
});

function filterEvents(type) {
    let filtered = [];
    if (type === 'todas') {
        filtered = allEvents;
    } else {
        filtered = allEvents.filter(e => e.type === type);
    }
    calendar.removeAllEvents();
    calendar.addEventSource(filtered);

    document.querySelectorAll('.filters button').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
}
</script>

</body>
</html>
